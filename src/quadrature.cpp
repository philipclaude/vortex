#include "quadrature.h"

namespace vortex {

template <typename T>
void TriangleQuadrature<T>::define(int order) {
  // determine number of points to use from requested order
  static const int sizes[11] = {1, 1, 3, 4, 6, 7, 12, 13, 16, 19, 25};
  if (order < 0) order = 10;
  if (order > 10) order = 10;
  int n = sizes[order];

  // define the quadrature points and weights
  std::vector<coord_t> x(2 * n), w(n);
  switch (order) {
    case 0:
      x[0] = 3.333333333333333e-01;
      x[1] = 3.333333333333333e-01;

      w[0] = 5.000000000000000e-01;
      break;
    case 1:
      x[0] = 3.333333333333333e-01;
      x[1] = 3.333333333333333e-01;

      w[0] = 5.000000000000000e-01;
      break;
    case 2:
      x[0] = 6.666666666666666e-01;
      x[1] = 1.666666666666667e-01;
      x[2] = 1.666666666666667e-01;
      x[3] = 6.666666666666666e-01;
      x[4] = 1.666666666666667e-01;
      x[5] = 1.666666666666667e-01;

      w[0] = 1.666666666666667e-01;
      w[1] = 1.666666666666667e-01;
      w[2] = 1.666666666666667e-01;
      break;
    case 3:
      x[0] = 3.333333333333333e-01;
      x[1] = 3.333333333333333e-01;
      x[2] = 6.000000000000000e-01;
      x[3] = 2.000000000000000e-01;
      x[4] = 2.000000000000000e-01;
      x[5] = 6.000000000000000e-01;
      x[6] = 2.000000000000000e-01;
      x[7] = 2.000000000000000e-01;

      w[0] = -2.812500000000000e-01;
      w[1] = 2.604166666666667e-01;
      w[2] = 2.604166666666667e-01;
      w[3] = 2.604166666666667e-01;
      break;
    case 4:
      x[0] = 1.081030181680700e-01;
      x[1] = 4.459484909159650e-01;
      x[2] = 4.459484909159650e-01;
      x[3] = 1.081030181680700e-01;
      x[4] = 4.459484909159650e-01;
      x[5] = 4.459484909159650e-01;
      x[6] = 8.168475729804590e-01;
      x[7] = 9.157621350977101e-02;
      x[8] = 9.157621350977101e-02;
      x[9] = 8.168475729804590e-01;
      x[10] = 9.157621350977101e-02;
      x[11] = 9.157621350977101e-02;

      w[0] = 1.116907948390055e-01;
      w[1] = 1.116907948390055e-01;
      w[2] = 1.116907948390055e-01;
      w[3] = 5.497587182766100e-02;
      w[4] = 5.497587182766100e-02;
      w[5] = 5.497587182766100e-02;
      break;
    case 5:
      x[0] = 3.333333333333330e-01;
      x[1] = 3.333333333333330e-01;
      x[2] = 5.971587178977000e-02;
      x[3] = 4.701420641051150e-01;
      x[4] = 4.701420641051150e-01;
      x[5] = 5.971587178977000e-02;
      x[6] = 4.701420641051150e-01;
      x[7] = 4.701420641051150e-01;
      x[8] = 7.974269853530870e-01;
      x[9] = 1.012865073234560e-01;
      x[10] = 1.012865073234560e-01;
      x[11] = 7.974269853530870e-01;
      x[12] = 1.012865073234560e-01;
      x[13] = 1.012865073234560e-01;

      w[0] = 1.125000000000000e-01;
      w[1] = 6.619707639425300e-02;
      w[2] = 6.619707639425300e-02;
      w[3] = 6.619707639425300e-02;
      w[4] = 6.296959027241350e-02;
      w[5] = 6.296959027241350e-02;
      w[6] = 6.296959027241350e-02;
      break;
    case 6:
      x[0] = 5.014265096581790e-01;
      x[1] = 2.492867451709100e-01;
      x[2] = 2.492867451709100e-01;
      x[3] = 5.014265096581790e-01;
      x[4] = 2.492867451709100e-01;
      x[5] = 2.492867451709100e-01;
      x[6] = 8.738219710169960e-01;
      x[7] = 6.308901449150200e-02;
      x[8] = 6.308901449150200e-02;
      x[9] = 8.738219710169960e-01;
      x[10] = 6.308901449150200e-02;
      x[11] = 6.308901449150200e-02;
      x[12] = 5.314504984481700e-02;
      x[13] = 3.103524510337840e-01;
      x[14] = 6.365024991213990e-01;
      x[15] = 5.314504984481700e-02;
      x[16] = 3.103524510337840e-01;
      x[17] = 6.365024991213990e-01;
      x[18] = 5.314504984481700e-02;
      x[19] = 6.365024991213990e-01;
      x[20] = 6.365024991213990e-01;
      x[21] = 3.103524510337840e-01;
      x[22] = 3.103524510337840e-01;
      x[23] = 5.314504984481700e-02;

      w[0] = 5.839313786318950e-02;
      w[1] = 5.839313786318950e-02;
      w[2] = 5.839313786318950e-02;
      w[3] = 2.542245318510350e-02;
      w[4] = 2.542245318510350e-02;
      w[5] = 2.542245318510350e-02;
      w[6] = 4.142553780918700e-02;
      w[7] = 4.142553780918700e-02;
      w[8] = 4.142553780918700e-02;
      w[9] = 4.142553780918700e-02;
      w[10] = 4.142553780918700e-02;
      w[11] = 4.142553780918700e-02;
      break;
    case 7:
      x[0] = 3.333333333333330e-01;
      x[1] = 3.333333333333330e-01;
      x[2] = 4.793080678419200e-01;
      x[3] = 2.603459660790400e-01;
      x[4] = 2.603459660790400e-01;
      x[5] = 4.793080678419200e-01;
      x[6] = 2.603459660790400e-01;
      x[7] = 2.603459660790400e-01;
      x[8] = 8.697397941955680e-01;
      x[9] = 6.513010290221601e-02;
      x[10] = 6.513010290221601e-02;
      x[11] = 8.697397941955680e-01;
      x[12] = 6.513010290221601e-02;
      x[13] = 6.513010290221601e-02;
      x[14] = 4.869031542531600e-02;
      x[15] = 3.128654960048740e-01;
      x[16] = 6.384441885698100e-01;
      x[17] = 4.869031542531600e-02;
      x[18] = 3.128654960048740e-01;
      x[19] = 6.384441885698100e-01;
      x[20] = 4.869031542531600e-02;
      x[21] = 6.384441885698100e-01;
      x[22] = 6.384441885698100e-01;
      x[23] = 3.128654960048740e-01;
      x[24] = 3.128654960048740e-01;
      x[25] = 4.869031542531600e-02;

      w[0] = -7.478502223384099e-02;
      w[1] = 8.780762871660400e-02;
      w[2] = 8.780762871660400e-02;
      w[3] = 8.780762871660400e-02;
      w[4] = 2.667361780441900e-02;
      w[5] = 2.667361780441900e-02;
      w[6] = 2.667361780441900e-02;
      w[7] = 3.855688044512850e-02;
      w[8] = 3.855688044512850e-02;
      w[9] = 3.855688044512850e-02;
      w[10] = 3.855688044512850e-02;
      w[11] = 3.855688044512850e-02;
      w[12] = 3.855688044512850e-02;
      break;
    case 8:
      x[0] = 3.333333333333330e-01;
      x[1] = 3.333333333333330e-01;
      x[2] = 8.141482341455400e-02;
      x[3] = 4.592925882927230e-01;
      x[4] = 4.592925882927230e-01;
      x[5] = 8.141482341455400e-02;
      x[6] = 4.592925882927230e-01;
      x[7] = 4.592925882927230e-01;
      x[8] = 6.588613844964800e-01;
      x[9] = 1.705693077517600e-01;
      x[10] = 1.705693077517600e-01;
      x[11] = 6.588613844964800e-01;
      x[12] = 1.705693077517600e-01;
      x[13] = 1.705693077517600e-01;
      x[14] = 8.989055433659380e-01;
      x[15] = 5.054722831703100e-02;
      x[16] = 5.054722831703100e-02;
      x[17] = 8.989055433659380e-01;
      x[18] = 5.054722831703100e-02;
      x[19] = 5.054722831703100e-02;
      x[20] = 8.394777409958001e-03;
      x[21] = 2.631128296346380e-01;
      x[22] = 7.284923929554040e-01;
      x[23] = 8.394777409958001e-03;
      x[24] = 2.631128296346380e-01;
      x[25] = 7.284923929554040e-01;
      x[26] = 8.394777409958001e-03;
      x[27] = 7.284923929554040e-01;
      x[28] = 7.284923929554040e-01;
      x[29] = 2.631128296346380e-01;
      x[30] = 2.631128296346380e-01;
      x[31] = 8.394777409958001e-03;

      w[0] = 7.215780383889350e-02;
      w[1] = 4.754581713364250e-02;
      w[2] = 4.754581713364250e-02;
      w[3] = 4.754581713364250e-02;
      w[4] = 5.160868526735900e-02;
      w[5] = 5.160868526735900e-02;
      w[6] = 5.160868526735900e-02;
      w[7] = 1.622924881159900e-02;
      w[8] = 1.622924881159900e-02;
      w[9] = 1.622924881159900e-02;
      w[10] = 1.361515708721750e-02;
      w[11] = 1.361515708721750e-02;
      w[12] = 1.361515708721750e-02;
      w[13] = 1.361515708721750e-02;
      w[14] = 1.361515708721750e-02;
      w[15] = 1.361515708721750e-02;
      break;
    case 9:
      x[0] = 3.333333333333330e-01;
      x[1] = 3.333333333333330e-01;
      x[2] = 2.063496160252500e-02;
      x[3] = 4.896825191987380e-01;
      x[4] = 4.896825191987380e-01;
      x[5] = 2.063496160252500e-02;
      x[6] = 4.896825191987380e-01;
      x[7] = 4.896825191987380e-01;
      x[8] = 1.258208170141270e-01;
      x[9] = 4.370895914929370e-01;
      x[10] = 4.370895914929370e-01;
      x[11] = 1.258208170141270e-01;
      x[12] = 4.370895914929370e-01;
      x[13] = 4.370895914929370e-01;
      x[14] = 6.235929287619350e-01;
      x[15] = 1.882035356190330e-01;
      x[16] = 1.882035356190330e-01;
      x[17] = 6.235929287619350e-01;
      x[18] = 1.882035356190330e-01;
      x[19] = 1.882035356190330e-01;
      x[20] = 9.105409732110950e-01;
      x[21] = 4.472951339445300e-02;
      x[22] = 4.472951339445300e-02;
      x[23] = 9.105409732110950e-01;
      x[24] = 4.472951339445300e-02;
      x[25] = 4.472951339445300e-02;
      x[26] = 3.683841205473600e-02;
      x[27] = 2.219629891607660e-01;
      x[28] = 7.411985987844980e-01;
      x[29] = 3.683841205473600e-02;
      x[30] = 2.219629891607660e-01;
      x[31] = 7.411985987844980e-01;
      x[32] = 3.683841205473600e-02;
      x[33] = 7.411985987844980e-01;
      x[34] = 7.411985987844980e-01;
      x[35] = 2.219629891607660e-01;
      x[36] = 2.219629891607660e-01;
      x[37] = 3.683841205473600e-02;

      w[0] = 4.856789814139950e-02;
      w[1] = 1.566735011356950e-02;
      w[2] = 1.566735011356950e-02;
      w[3] = 1.566735011356950e-02;
      w[4] = 3.891377050238700e-02;
      w[5] = 3.891377050238700e-02;
      w[6] = 3.891377050238700e-02;
      w[7] = 3.982386946360500e-02;
      w[8] = 3.982386946360500e-02;
      w[9] = 3.982386946360500e-02;
      w[10] = 1.278883782934900e-02;
      w[11] = 1.278883782934900e-02;
      w[12] = 1.278883782934900e-02;
      w[13] = 2.164176968864450e-02;
      w[14] = 2.164176968864450e-02;
      w[15] = 2.164176968864450e-02;
      w[16] = 2.164176968864450e-02;
      w[17] = 2.164176968864450e-02;
      w[18] = 2.164176968864450e-02;
      break;
    case 10:
      x[0] = 3.333333333333330e-01;
      x[1] = 3.333333333333330e-01;
      x[2] = 2.884473323268500e-02;
      x[3] = 4.855776333836570e-01;
      x[4] = 4.855776333836570e-01;
      x[5] = 2.884473323268500e-02;
      x[6] = 4.855776333836570e-01;
      x[7] = 4.855776333836570e-01;
      x[8] = 7.810368490299260e-01;
      x[9] = 1.094815754850370e-01;
      x[10] = 1.094815754850370e-01;
      x[11] = 7.810368490299260e-01;
      x[12] = 1.094815754850370e-01;
      x[13] = 1.094815754850370e-01;
      x[14] = 1.417072194148800e-01;
      x[15] = 3.079398387641210e-01;
      x[16] = 5.503529418209990e-01;
      x[17] = 1.417072194148800e-01;
      x[18] = 3.079398387641210e-01;
      x[19] = 5.503529418209990e-01;
      x[20] = 1.417072194148800e-01;
      x[21] = 5.503529418209990e-01;
      x[22] = 5.503529418209990e-01;
      x[23] = 3.079398387641210e-01;
      x[24] = 3.079398387641210e-01;
      x[25] = 1.417072194148800e-01;
      x[26] = 2.500353476268600e-02;
      x[27] = 2.466725606399030e-01;
      x[28] = 7.283239045974110e-01;
      x[29] = 2.500353476268600e-02;
      x[30] = 2.466725606399030e-01;
      x[31] = 7.283239045974110e-01;
      x[32] = 2.500353476268600e-02;
      x[33] = 7.283239045974110e-01;
      x[34] = 7.283239045974110e-01;
      x[35] = 2.466725606399030e-01;
      x[36] = 2.466725606399030e-01;
      x[37] = 2.500353476268600e-02;
      x[38] = 9.540815400299000e-03;
      x[39] = 6.680325101220000e-02;
      x[40] = 9.236559335875000e-01;
      x[41] = 9.540815400299000e-03;
      x[42] = 6.680325101220000e-02;
      x[43] = 9.236559335875000e-01;
      x[44] = 9.540815400299000e-03;
      x[45] = 9.236559335875000e-01;
      x[46] = 9.236559335875000e-01;
      x[47] = 6.680325101220000e-02;
      x[48] = 6.680325101220000e-02;
      x[49] = 9.540815400299000e-03;

      w[0] = 4.540899519137700e-02;
      w[1] = 1.836297887823350e-02;
      w[2] = 1.836297887823350e-02;
      w[3] = 1.836297887823350e-02;
      w[4] = 2.266052971776400e-02;
      w[5] = 2.266052971776400e-02;
      w[6] = 2.266052971776400e-02;
      w[7] = 3.637895842271000e-02;
      w[8] = 3.637895842271000e-02;
      w[9] = 3.637895842271000e-02;
      w[10] = 3.637895842271000e-02;
      w[11] = 3.637895842271000e-02;
      w[12] = 3.637895842271000e-02;
      w[13] = 1.416362126552850e-02;
      w[14] = 1.416362126552850e-02;
      w[15] = 1.416362126552850e-02;
      w[16] = 1.416362126552850e-02;
      w[17] = 1.416362126552850e-02;
      w[18] = 1.416362126552850e-02;
      w[19] = 4.710833481866500e-03;
      w[20] = 4.710833481866500e-03;
      w[21] = 4.710833481866500e-03;
      w[22] = 4.710833481866500e-03;
      w[23] = 4.710833481866500e-03;
      w[24] = 4.710833481866500e-03;
      break;
    default:
      NOT_POSSIBLE;
  }

  // save the result
  points_.resize(n);
  weights_.resize(n);
  for (int i = 0; i < n; i++) {
    points_[i][0] = x[2 * i];
    points_[i][1] = x[2 * i + 1];
    weights_[i] = w[i];
  }
}

template class TriangleQuadrature<Triangle>;
template class TriangleQuadrature<SphericalTriangle>;

}  // namespace vortex